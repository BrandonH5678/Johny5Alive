# J5A Nightshift Log Rotation Configuration
# Install to /etc/logrotate.d/j5a-nightshift

/home/johnny5/Johny5Alive/j5a-nightshift/ops/logs/*.log {
    # Rotate daily
    daily

    # Keep 30 days of logs
    rotate 30

    # Compress old logs
    compress

    # Delay compression until next rotation (keeps most recent readable)
    delaycompress

    # Don't error if log is missing
    missingok

    # Don't rotate empty logs
    notifempty

    # Create new log file with these permissions
    create 0644 johnny5 johnny5

    # Use date as suffix for rotated files
    dateext
    dateformat -%Y%m%d

    # Shared scripts run only once for all log files
    sharedscripts

    # Commands to run after rotation
    postrotate
        # Reload service if running (allows it to start using new log file)
        systemctl reload j5a-nightshift.service 2>/dev/null || true
    endscript
}

# Separate configuration for summary logs (keep longer)
/home/johnny5/Johny5Alive/j5a-nightshift/ops/logs/summaries/*.md {
    weekly
    rotate 52
    compress
    delaycompress
    missingok
    notifempty
    create 0644 johnny5 johnny5
    dateext
    dateformat -%Y%m%d
}
